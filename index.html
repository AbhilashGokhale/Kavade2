<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kavade</title>
    <link rel="stylesheet" href="file.css">
</head>

<body>

    <div class="FrameDiv">
        <div class="Point_display Point_display1" id="Point_display1"></div>

        <div class="LineDiv">
            <div class="Box" id="2"></div>
            <div class="Box" id="1"></div>
            <div class="Boxsafe" id="0">
                <div class="square border border-dark p-3" style="display: flex; flex-wrap: wrap;">
                    <div class="row">
                        <div class="col-6 ">
                            <div id="red_1" class="pawn pawn1" onclick="MovePawn(this.id)"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 expand_pawn ">
                            <div id="red_2" class="pawn pawn1" onclick="MovePawn(this.id)"></div>
                        </div>
                        <div class="col-6 expand_pawn">
                            <div id="red_3" class="pawn pawn1" onclick="MovePawn(this.id)"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6">
                            <div id="red_4" class="pawn pawn1" onclick="MovePawn(this.id)"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="Box" id="15"></div>
            <div class="Box" id="14"></div>
        </div>

        <div class="LineDiv">
            <div class="Box" id="3"></div>
            <div class="Box" id="22"></div>
            <div class="Box" id="23"></div>
            <div class="Box" id="16"></div>
            <div class="Box" id="13"></div>
        </div>

        <div class="LineDiv">
            <div class="Boxsafe" id="4">
                <div class="square border border-dark p-3" style="display: flex; flex-wrap: wrap;">
                    <div class="row">
                        <div class="col-6">
                            <div id="blue_1" class="pawn pawn2" onclick="MovePawn(this.id)"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 expand_pawn">
                            <div id="blue_2" class="pawn pawn2" onclick="MovePawn(this.id)"></div>
                        </div>
                        <div class="col-6 expand_pawn">
                            <div id="blue_3" class="pawn pawn2" onclick="MovePawn(this.id)"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6">
                            <div id="blue_4" class="pawn pawn2" onclick="MovePawn(this.id)"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="Box" id="21"></div>
            <div class="Boxsafe" id="24">
                <button class="roll_btn" id="roll_btn" type="button" onclick="Roll();"></button>
            </div>
            <div class="Box" id="17"></div>
            <div class="Boxsafe" id="12">
                <div class="square border border-dark p-3" style="display: flex; flex-wrap: wrap;">
                    <div class="row">
                        <div class="col-6">
                            <div id="black_1" class="pawn pawn3" onclick="MovePawn(this.id)"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 expand_pawn">
                            <div id="black_2" class="pawn pawn3" onclick="MovePawn(this.id)"></div>
                        </div>
                        <div class="col-6 expand_pawn">
                            <div id="black_3" class="pawn pawn3" onclick="MovePawn(this.id)"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6">
                            <div id="black_4" class="pawn pawn3" onclick="MovePawn(this.id)"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="LineDiv">
            <div class="Box" id="5"></div>
            <div class="Box" id="20"></div>
            <div class="Box" id="19"></div>
            <div class="Box" id="18"></div>
            <div class="Box" id="11"></div>
        </div>

        <div class="LineDiv">
            <div class="Box" id="6"></div>
            <div class="Box" id="7"></div>
            <div class="Boxsafe" id="8">
                <div class="square border border-dark p-3" style="display: flex; flex-wrap: wrap;">
                    <div class="row">
                        <div class="col-6">
                            <div id="yellow_1" class="pawn pawn4" onclick="MovePawn(this.id)"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6 expand_pawn">
                            <div id="yellow_2" class="pawn pawn4" onclick="MovePawn(this.id)"></div>
                        </div>
                        <div class="col-6 expand_pawn">
                            <div id="yellow_3" class="pawn pawn4" onclick="MovePawn(this.id)"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-6">
                            <div id="yellow_4" class="pawn pawn4" onclick="MovePawn(this.id)"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="Box" id="9"></div>
            <div class="Box" id="10"></div>
        </div>
        <div class="Point_display" id="Point_display2"></div>
    </div>
    <div id="win_pawns"></div>
    <script>
        var Roll_val = 0;
        function Roll() {
            document.getElementById('roll_btn').style.visibility = 'visible';
            Roll_val = parseInt(Math.random() * 16);

            if (Roll_val == 0 || Roll_val == 1 || Roll_val == 2 || Roll_val == 3) {
                Roll_val = 1;
            }
            else if (Roll_val == 4 || Roll_val == 5 || Roll_val == 6 || Roll_val == 7 || Roll_val == 8 || Roll_val == 9) {
                Roll_val = 2;
            }
            else if (Roll_val == 10 || Roll_val == 11 || Roll_val == 12 || Roll_val == 13) {
                Roll_val = 3;
            }
            else if (Roll_val == 14) {
                Roll_val = 4;
            }
            else if (Roll_val == 15) {
                Roll_val = 8;
            }

            if (Roll_val == 1 || Roll_val == 2 || Roll_val == 3) {
                document.getElementById('roll_btn').style.visibility = 'hidden';
            }

            var current_val = document.getElementById('Point_display1').innerHTML;
            if (current_val == 1 || current_val == 2 || current_val == 3 || current_val == "" || current_val == 0) {
                Roll_val = Roll_val
            }
            else {
                Roll_val = current_val.concat(' + ', Roll_val);
            }

            document.getElementById('Point_display1').innerHTML = Roll_val;
            document.getElementById('Point_display2').innerHTML = Roll_val;

        }


        function MovePawn(Pawn_id) {
            var visibility = document.getElementById('roll_btn').style.visibility;
            if (visibility == 'visible') {

                document.getElementById('roll_btn').classList.add('rotateable');
                document.getElementById('roll_btn').style.transform = 'scaleX(1.1)';
                setTimeout(function () {
                    document.getElementById('roll_btn').style.transform = 'scaleX(0.9)';
                    setTimeout(function () {
                        document.getElementById('roll_btn').style.transform = 'scaleX(1.1)';
                        setTimeout(function () {
                            document.getElementById('roll_btn').style.transform = 'scaleX(0.9)';
                            setTimeout(function () {
                                document.getElementById('roll_btn').style.transform = 'scaleX(1.1)';
                                setTimeout(function () {
                                    document.getElementById('roll_btn').style.transform = 'scaleX(0.9)';
                                    setTimeout(function () {
                                        document.getElementById('roll_btn').style.transform = 'scaleX(1)';
                                    }, 10);
                                }, 10);
                            }, 10);
                        }, 10);
                    }, 10);
                }, 10);
                return;
            }
            var current_val = document.getElementById('Point_display1').innerHTML; //get moves value
            //-------------------------------------------------------------------------------------------------------------------------------------
            if (current_val == "") {                                               // if empty set it to 0
                current_val = "0";
            };
            //-------------------------------------------------------------------------------------------------------------------------------------
            if (current_val.includes('+')) {                                       // If + is there split it and save it in a n array
                var current_vals = current_val.split('+');

                for (i = 0; i < current_vals.length; i++) {
                    current_vals[i] = current_vals[i].replaceAll(" ", "")
                }
            }
            else {
                current_vals = [current_val];
            };
            //-------------------------------------------------------------------------------------------------------------------------------------
            if (document.getElementById(Pawn_id).parentNode.id != "") {             // Get current position
                var current_pos = document.getElementById(Pawn_id).parentNode.id;
            }
            else {
                current_pos = document.getElementById(Pawn_id).parentNode.parentNode.parentNode.parentNode.id;
            }
            //-------------------------------------------------------------------------------------------------------------------------------------
            if (current_vals.length > 1) {                                                //Get correct value if there are multiple values
                while (!(current_vals.includes(current_value))) {
                    var current_value = prompt("Choose an option in  " + current_val.replaceAll("+", ","));
                }
            }
            else {
                current_value = current_vals[0];
            }
            //-------------------------------------------------------------------------------------------------------------------------------------
            //Check if number is allowed
            if (Pawn_id.includes('red')) {
                if (current_pos == "23") {
                    if (current_value > 1) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "22") {
                    if (current_value > 2) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "21") {
                    if (current_value > 3) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "20") {
                    if (current_value > 4) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "19" || current_pos == "18" || current_pos == "17") {
                    if (current_value > 7) {
                        alert("Move any other pawn");
                        return;
                    }
                }
            }
            else if (Pawn_id.includes('blue')) {
                if (current_pos == "21") {
                    if (current_value > 1) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "20") {
                    if (current_value > 2) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "19") {
                    if (current_value > 3) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "18") {
                    if (current_value > 4) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "17" || current_pos == "16" || current_pos == "23") {
                    if (current_value > 7) {
                        alert("Move any other pawn");
                        return;
                    }
                }
            }
            else if (Pawn_id.includes('black')) {
                if (current_pos == "17") {
                    if (current_value > 1) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "16") {
                    if (current_value > 2) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "23") {
                    if (current_value > 3) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "22") {
                    if (current_value > 4) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "21" || current_pos == "20" || current_pos == "19") {
                    if (current_value > 7) {
                        alert("Move any other pawn");
                        return;
                    }
                }
            }
            else if (Pawn_id.includes('yellow')) {
                if (current_pos == "19") {
                    if (current_value > 1) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "18") {
                    if (current_value > 2) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "17") {
                    if (current_value > 3) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "16") {
                    if (current_value > 4) {
                        alert("Move any other pawn");
                        return;
                    }
                }
                if (current_pos == "23" || current_pos == "22" || current_pos == "21") {
                    if (current_value > 7) {
                        alert("Move any other pawn");
                        return;
                    }
                }
            }

            //-------------------------------------------------------------------------------------------------------------------------------------
            skip_this_loop = false;
            var loop_counter = 0;
            pawn_to_pos = parseInt(current_pos);
            var starting_pos = current_pos;
            var pawn_to_pos_last = parseInt(current_pos);

            for (i = 0; i < parseInt(current_value); i++) {
                setTimeout(() => {
                    loop_counter = loop_counter + 1;
                    pawn_to_pos = 1 + pawn_to_pos;
                    pawn_to_pos = correct_pos(pawn_to_pos, pawn_to_pos_last, Pawn_id);
                    document.getElementById(pawn_to_pos).appendChild(document.getElementById(Pawn_id));
                    pawn_to_pos_last = pawn_to_pos;



                    if (loop_counter == parseInt(current_value)) {
                        if (pawn_to_pos != 0 || pawn_to_pos != 4 || pawn_to_pos != 8 || pawn_to_pos != 12 || pawn_to_pos != 24) {
                            try { var prev_element = document.getElementById(Pawn_id).previousSibling.id; }
                            catch (err) { }
                        }
                        if (prev_element != undefined) {
                            var prev_id = prev_element.split("_");
                            var curr_id = Pawn_id.split("_");
                            if (curr_id[0] == prev_id[0]) {
                                alert("Move another pawn");
                                document.getElementById(starting_pos).appendChild(document.getElementById(Pawn_id));
                                return;
                            }
                            else {
                                kill(Pawn_id, prev_element);
                            }
                        }

                        var display_val = "";
                        var skipped = false;
                        var first = true;

                        if (current_vals.length > 1) {
                            for (i = 0; i < current_vals.length; i++) {
                                if (!(skipped)) {
                                    if (current_vals[i] != current_value) {
                                        if (first) {
                                            display_val = current_vals[i];
                                            first = false;
                                        }
                                        else {
                                            display_val = display_val.concat(" + ", current_vals[i]);
                                        }
                                    } else {
                                        skipped = true;
                                    }
                                }
                                else {
                                    if (first) {
                                        display_val = current_vals[i];
                                        first = false;
                                    }
                                    else {
                                        display_val = display_val.concat(" + ", current_vals[i]);
                                    }
                                }
                            }

                            document.getElementById('Point_display1').innerHTML = display_val;
                            document.getElementById('Point_display2').innerHTML = display_val;
                        }
                        else {

                            document.getElementById('Point_display1').innerHTML = "0";
                            document.getElementById('Point_display2').innerHTML = "0";

                            document.getElementById('roll_btn').style.visibility = 'visible';
                        }
                        if (document.getElementById(Pawn_id).parentNode.id == "24") {
                            document.getElementById(Pawn_id).style.visibility = "hidden";
                            document.getElementById(Pawn_id).style.border = "0px";
                            document.getElementById(Pawn_id).style.margin = "0px";
                            document.getElementById("win_pawns").appendChild(document.getElementById(Pawn_id));
                        };
                    }

                }, i * 200);
            }

            function kill(Pawn_id, prev_id) {
                if (prev_id.includes('red')) {
                    document.getElementById("0").appendChild(document.getElementById(prev_id))
                }
                else if (prev_id.includes('blue')) {
                    document.getElementById("4").appendChild(document.getElementById(prev_id))
                }
                else if (prev_id.includes('yellow')) {
                    document.getElementById("8").appendChild(document.getElementById(prev_id))
                }
                else if (prev_id.includes('black')) {
                    document.getElementById("12").appendChild(document.getElementById(prev_id))
                }

            }
            function correct_pos(pawn_to_pos, pawn_to_pos_last, Pawn_id) {
                if (Pawn_id.includes('red')) {
                    return pawn_to_pos;
                }
                else if (Pawn_id.includes('blue')) {
                    if (pawn_to_pos == 16) {
                        if (pawn_to_pos_last == 15) {
                            return 0;
                        }
                        else {
                            return pawn_to_pos;
                        }
                    }
                    else if (pawn_to_pos == 4) {
                        if (pawn_to_pos_last == 3) {
                            return 22;
                        }
                        else {
                            return pawn_to_pos;
                        }
                    }
                    else if (pawn_to_pos == 24) {
                        if (pawn_to_pos_last == 23) {
                            return 16;
                        }
                        else {
                            return pawn_to_pos;
                        }
                    }
                    else if (pawn_to_pos == 22) {
                        if (pawn_to_pos_last == 21) {
                            return 24;
                        }
                        else {
                            return pawn_to_pos;
                        }
                    }
                    else {
                        return pawn_to_pos;
                    }
                }
                else if (Pawn_id.includes('yellow')) {
                    if (pawn_to_pos == 16) {
                        if (pawn_to_pos_last == 15) {
                            return 0;
                        }
                        else {
                            return pawn_to_pos;
                        }
                    }
                    else if (pawn_to_pos == 8) {
                        if (pawn_to_pos_last == 7) {
                            return 20;
                        }
                        else {
                            return pawn_to_pos;
                        }
                    }
                    else if (pawn_to_pos == 24) {
                        if (pawn_to_pos_last == 23) {
                            return 16;
                        }
                        else {
                            return pawn_to_pos;
                        }
                    }
                    else if (pawn_to_pos == 20) {
                        if (pawn_to_pos_last == 19) {
                            return 24;
                        }
                        else {
                            return pawn_to_pos;
                        }
                    }
                    else {
                        return pawn_to_pos;
                    }
                }
                else if (Pawn_id.includes('black')) {
                    if (pawn_to_pos == 16) {
                        if (pawn_to_pos_last == 15) {
                            return 0;
                        }
                        else {
                            return pawn_to_pos;
                        }
                    }
                    else if (pawn_to_pos == 12) {
                        if (pawn_to_pos_last == 11) {
                            return 18;
                        }
                        else {
                            return pawn_to_pos;
                        }
                    }
                    else if (pawn_to_pos == 24) {
                        if (pawn_to_pos_last == 23) {
                            return 16;
                        }
                        else {
                            return pawn_to_pos;
                        }
                    }
                    else if (pawn_to_pos == 18) {
                        if (pawn_to_pos_last == 17) {
                            return 24;
                        }
                        else {
                            return pawn_to_pos;
                        }
                    }
                    else {
                        return pawn_to_pos;
                    }
                }
            };
            //-------------------------------------------------------------------------------------------------------------------------------------

        }
    </script>
</body>

</html>